<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forgot Password</title>
    <link rel="stylesheet" href="dist/assets/css/forgot_password.css">
</head>
<body>
    <section class="parent">
        <!-- LEFT SIDE: FORM -->
        <div class="user-info">
            <h1>Forgot Password</h1>

            <form action=""  name="form-name" id="formEL">
                <div class="input-box">
                    <label for="email">Email Address</label>
                    <input type="text" id="email" name="email" required>
                </div>
                
                <div class="btn-box">   
                    <button type="submit">Continue</button>
                </div>
            </form>

        </div>

        <!-- RIGHT SIDE: IMAGE -->
        <div class="bank-img">
            <img src="dist/assets/images/Frame 337.png" alt="Bank Illustration">
        </div>
    </section>
</body>
<script>
    const formEl = document.getElementById('formEL');

    formEl.addEventListener('submit', async(event) => {
        event.preventDefault(); // Prevent the default form submission behavior
        const data = new FormData(formEl);
        const dataObj = Object.fromEntries(data);
        const dataEmail = dataObj.email;
        try {
            const response = await fetch(`http://localhost:5000/users?email=${dataEmail}`);
            if (!response) {
                throw new Error(`Error: ${response.status} ${response.statusText}`);  
            };
            const responseData = await response.json();
            console.log('Response Data:', responseData);
            if (responseData.length > 0) {
                alert(`Password reset link sent to ${dataEmail}. Please check your email.`);
                // Here you can add code to handle the form data, e.g., send it to a server

                // For demonstration, we'll just redirect to another page
                // window.location.href = ''; // Redirect to reset password page
            } else {
                alert(`No account found with email: ${dataEmail}, Please create an account.`);
                // window.location.href = ''; // Redirect to reset password page

            }
        } catch (error) {
            console.error('Error:', error);
        }
        // const email = dataObj.email;
        // alert(`Password reset link sent to ${email}. Please check your email.`);
        // Here you can add code to handle the form data, e.g., send it to a server

        // For demonstration, we'll just redirect to another page
        // window.location.href = 'reset_password.html'; // Redirect to reset password page
    });
</script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</html>